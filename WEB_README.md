# 视觉虚拟健身教练 - Web界面使用说明

## 项目介绍

这是一个基于AI的太极拳动作评估系统的Web前端界面，支持视频上传和实时摄像头分析两种模式。

## 功能特性

### 1. 视频上传分析
- 支持多种视频格式（MP4, AVI, MOV, MKV, FLV, WMV）
- 最大支持100MB的视频文件
- 实时显示处理进度
- 智能关键帧选择
- AI模型动作质量评估

### 2. 实时摄像头分析
- 实时人体姿态检测
- 即时动作反馈
- 实时显示动作指标
- 流畅的视频流显示

### 3. 分析结果展示
- **动作评分**：0-100分的质量评分，带圆环动画展示
- **AI建议**：针对动作的改进建议
- **实时反馈**：基于规则的即时反馈信息
- **动作指标**：详细的身体姿态参数

## 安装步骤

### 1. 环境要求
- Python 3.8+
- pip 包管理器
- 摄像头（用于实时分析）

### 2. 安装依赖

```bash
# 安装Python依赖
pip install -r requirements.txt
```

### 3. 确保数据文件存在

确保以下文件存在：
- `data/models/taichi_mlp_v2.h5` - 训练好的模型
- `data/training/scaler.pkl` - 数据标准化器
- `data/standard/qishi3_standard_frames.json` - 标准动作数据

## 启动服务

```bash
# 启动Flask服务器
python app.py
```

服务器将在 `http://localhost:5000` 启动

## 使用方法

### 方式一：上传视频分析

1. 打开浏览器访问 `http://localhost:5000`
2. 点击"上传视频"按钮
3. 选择要分析的太极拳视频
4. 等待视频处理完成
5. 查看分析结果和建议

### 方式二：实时摄像头分析

1. 打开浏览器访问 `http://localhost:5000`
2. 点击"启动摄像头"按钮
3. 允许浏览器访问摄像头
4. 在摄像头前练习太极拳动作
5. 实时查看反馈和指标

## 界面说明

### 视频显示区
- 显示上传的视频或实时摄像头画面
- 包含人体骨架点标注
- 处理进度条（视频模式）

### 实时反馈卡片
- 显示基于规则的即时反馈
- 根据反馈类型使用不同颜色
  - 绿色：动作良好
  - 黄色：需要注意
  - 红色：需要改进

### 动作评估卡片
- 圆环显示动作质量分数（0-100）
  - 绿色：80分以上（优秀）
  - 黄色：60-79分（良好）
  - 红色：60分以下（需改进）
- AI生成的改进建议

### 动作指标卡片
显示详细的身体姿态参数：
- 手臂高度比
- 躯干角度
- 双手距离
- 肩宽/臀宽
- 脚距
- 肘部角度
- 平均可见度

## API接口说明

### 上传视频
```
POST /api/upload
Content-Type: multipart/form-data
Body: video file
```

### 获取处理状态
```
GET /api/status
Response: {
  "is_processing": boolean,
  "current_frame": int,
  "total_frames": int,
  "metrics": array,
  "feedback": array,
  "final_result": object
}
```

### 启动摄像头
```
POST /api/camera/start
```

### 停止摄像头
```
POST /api/camera/stop
```

### 获取摄像头视频流
```
GET /api/camera/feed
```

## 技术栈

### 后端
- Flask - Web框架
- OpenCV - 视频处理
- MediaPipe - 人体姿态估计
- TensorFlow/Keras - 深度学习模型

### 前端
- HTML5 + CSS3 - 页面结构和样式
- JavaScript (ES6+) - 交互逻辑
- Fetch API - 异步数据请求

## 项目结构

```
visual-based-virtual-fitness-coach/
├── app.py                      # Flask应用主文件
├── templates/
│   └── index.html             # 前端页面
├── static/
│   ├── css/
│   │   └── style.css          # 样式文件
│   └── js/
│       └── main.js            # JavaScript逻辑
├── uploads/                    # 上传视频存储目录
├── src/                        # 核心功能模块
├── data/                       # 数据和模型文件
└── requirements.txt           # Python依赖
```

## 常见问题

### 1. 无法启动摄像头
- 检查摄像头是否被其他程序占用
- 确认浏览器有摄像头访问权限
- 尝试使用Chrome或Firefox浏览器

### 2. 视频上传失败
- 检查视频文件大小是否超过100MB
- 确认视频格式是否支持
- 检查服务器uploads目录是否有写入权限

### 3. 模型预测失败
- 确认模型文件存在：`data/models/taichi_mlp_v2.h5`
- 确认标准化器存在：`data/training/scaler.pkl`
- 检查视频中是否有清晰的人体动作

### 4. 页面加载缓慢
- 检查网络连接
- 确认服务器正常运行
- 清除浏览器缓存后重试

## 性能优化建议

1. **视频文件**：建议使用480p-720p分辨率的视频
2. **视频时长**：建议10-30秒的短视频
3. **光照条件**：确保拍摄环境光线充足
4. **背景简洁**：避免复杂背景干扰检测

## 更新日志

### v1.0.0 (2024-11-16)
- 初始版本发布
- 支持视频上传分析
- 支持实时摄像头分析
- 实时反馈显示
- AI动作评估
- 响应式设计

## 许可证

本项目基于原有系统开发，遵循相同的许可协议。

## 技术支持

如遇到问题，请检查：
1. Python依赖是否正确安装
2. 模型文件是否存在
3. 服务器日志输出信息

---

**祝你使用愉快！**
