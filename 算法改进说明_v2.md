# æ™ºèƒ½é€‰å¸§ç®—æ³•æ”¹è¿›è¯´æ˜ - v2.1

## ğŸ¯ æ”¹è¿›ç›®æ ‡

æ ¹æ®ç”¨æˆ·åé¦ˆï¼Œ**ç¬¬2å¸§çš„é€‰å–éœ€è¦æ›´åŠ ç²¾ç¡®**ã€‚ç¬¬2å¸§ä¸ä»…ä»…æ˜¯"è…¿éƒ¨æ‰“å¼€åˆæœŸ"ï¼Œæ›´é‡è¦çš„æ˜¯æ•æ‰**é‡å¿ƒè½¬ç§»åˆ°ä¸¤è„šä¸­ç‚¹**çš„å…³é”®æ—¶åˆ»ã€‚

---

## ğŸ“Š ç¬¬2å¸§çš„å…³é”®ç‰¹å¾åˆ†æ

### æ ‡å‡†ç¬¬2å¸§çš„æ•°æ®

```python
{
    "arm_height_ratio": 0.932,      # æ‰‹è‡‚ä»ç„¶é«˜ä¸¾
    "foot_distance": 0.187,          # è„šè·å·²ç»æ‰“å¼€ï¼ˆæ˜¯ç¬¬1å¸§0.077çš„2.4å€ï¼‰
    "nose_center_offset": -0.002,   # â­ å¤´éƒ¨å‡ ä¹å®Œå…¨å±…ä¸­ï¼ˆå…³é”®ï¼ï¼‰
    "torso_angle": 0.957,            # èº¯å¹²ä¿æŒç›´ç«‹
    "avg_visibility": 0.977          # å¯è§æ€§è‰¯å¥½
}
```

### ä¸å…¶ä»–å¸§çš„å¯¹æ¯”

| ç‰¹å¾ | ç¬¬1å¸§ | ç¬¬2å¸§ | ç¬¬3å¸§ | ç¬¬4å¸§ |
|------|-------|-------|-------|-------|
| `arm_height_ratio` | 0.984 | **0.932** | -0.036 | 0.625 |
| `foot_distance` | 0.077 | **0.187** | 0.252 | 0.285 |
| `nose_center_offset` | -0.001 | **-0.002** | -0.008 | -0.003 |

**å…³é”®å‘ç°**ï¼š
- âœ… æ‰‹è‡‚ä»ç„¶é«˜ä¸¾ï¼ˆ0.932ï¼Œæ¥è¿‘ç¬¬1å¸§çš„0.984ï¼‰
- âœ… è„šè·å·²ç»æ˜¾è‘—æ‰“å¼€ï¼ˆ0.187ï¼Œæ˜¯ç¬¬1å¸§çš„2.4å€ï¼‰
- âœ… **å¤´éƒ¨ä¿æŒå±…ä¸­**ï¼ˆ-0.002ï¼Œæ¥è¿‘0ï¼‰â† **æœ€é‡è¦çš„ç‰¹å¾**
- âœ… èº¯å¹²ä¿æŒç›´ç«‹ï¼ˆtorso_angleæ¥è¿‘0ï¼‰

---

## ğŸ”§ ç®—æ³•æ”¹è¿›å†…å®¹

### 1. ç‰¹å¾æƒé‡è°ƒæ•´

**ä¿®æ”¹å‰**ï¼ˆv1.0ï¼‰ï¼š
```python
1: {
    'arm_height_ratio': 4.0,
    'foot_distance': 5.0,
    'hand_distance': 2.0,
    'torso_angle': 2.0,
    'avg_visibility': 1.0,
}
```

**ç¬¬ä¸€æ¬¡æ”¹è¿›**ï¼ˆv2.0ï¼‰ï¼š
```python
1: {
    'arm_height_ratio': 5.0,
    'foot_distance': 5.0,
    'nose_center_offset': 6.0,
    'torso_angle': 2.0,
    'hand_distance': 2.0,
    'avg_visibility': 1.0,
}
```

**å½“å‰ç‰ˆæœ¬**ï¼ˆv2.1ï¼‰ï¼š
```python
1: {
    'arm_height_ratio': 5.5,
    'foot_distance': 5.5,
    'nose_center_offset': 7.0,
    'hip_balance_left': 4.0,
    'hip_balance_right': 4.0,
    'shoulder_balance_left': 3.0,
    'shoulder_balance_right': 3.0,
    'torso_angle': 3.5,
    'hand_distance': 2.0,
    'avg_visibility': 1.0,
}
```

**æ”¹è¿›è¯´æ˜ï¼ˆv2.1ï¼‰**ï¼š
- âœ… `nose_center_offset` æƒé‡æå‡è‡³ **7.0**ï¼Œè¿›ä¸€æ­¥å¼ºè°ƒâ€œå¤´éƒ¨å›ä¸­â€ã€‚
- âœ… æ–°å¢éª¨ç›†/è‚©éƒ¨å¹³è¡¡ç‰¹å¾ï¼ˆ`hip_balance`ã€`shoulder_balance`ï¼‰ï¼Œçº¦æŸèº«ä½“å·¦å³å¯¹ç§°ã€‚
- âœ… `arm_height_ratio`ã€`foot_distance` æƒé‡æå‡è‡³ **5.5**ï¼Œç¡®ä¿è„šè·ç¨³å®šã€æ‰‹è‡‚ä»é«˜ã€‚
- âœ… `torso_angle` æƒé‡æå‡è‡³ 3.5ï¼Œé…åˆå¹³è¡¡æŒ‡æ ‡é˜²æ­¢èº«ä½“ä»åœ¨å€¾æ–œã€‚
- âœ… ç»¼åˆæƒé‡è¿›ä¸€æ­¥å¢å¤§ï¼Œç¬¬äºŒå¸§åŒ¹é…ç²¾åº¦æ˜¾è‘—æå‡ã€‚

### 2. ç‰¹å¾å½’ä¸€åŒ–ä¸é˜¶æ®µé˜ˆå€¼

ä¸º `nose_center_offset` æ·»åŠ äº†ä¸“é—¨çš„å½’ä¸€åŒ–å¤„ç†ï¼š

```python
elif feature == 'nose_center_offset':
    # å¤´éƒ¨å±…ä¸­åç§»ï¼Œç›¸å¯¹äºè‚©å®½çš„å½’ä¸€åŒ–å·®å¼‚
    # æ ‡å‡†å€¼æ¥è¿‘0è¡¨ç¤ºå±…ä¸­ï¼Œå·®å¼‚è¶Šå°è¶Šå¥½
    shoulder_width = metrics.get('shoulder_width', 0.24)
    if shoulder_width <= 1e-6:
        shoulder_width = 0.24  # å›é€€åˆ°æ ‡å‡†å€¼
    diff = abs(val_current - val_standard) / (shoulder_width + 1e-6)
```

åŒæ—¶æ–°å¢äº†**é˜¶æ®µæ€§ç¡¬é˜ˆå€¼ç­›é€‰**ï¼ˆä»…å¯¹ç¬¬äºŒå¸§ç”Ÿæ•ˆï¼‰ï¼Œåªæœ‰æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„å¸§æ‰ä¼šè¿›å…¥ç›¸ä¼¼åº¦è®¡ç®—ï¼š

- `foot_distance / hip_width â‰¥ 1.25`
- `arm_height_ratio â‰¥ 0.55`
- `nose_center_offset / shoulder_width â‰¤ 0.45`
- `|hip_balance| â‰¤ 0.28`
- `|shoulder_balance| â‰¤ 0.35`
- `|torso_angle| â‰¤ 10Â°`

**ä¼˜ç‚¹**ï¼š
- ç›¸å¯¹äºè‚©å®½å½’ä¸€åŒ–é€‚åº”ä¸åŒä½“å‹ï¼ŒåŒæ—¶é…åˆç¡¬é˜ˆå€¼å¯è¿‡æ»¤å§¿æ€åå·®å¤§çš„å¸§ã€‚
- å³ä¾¿å¤´éƒ¨ä½ç½®ä¼°è®¡å­˜åœ¨å™ªå£°ï¼Œéª¨ç›†/è‚©éƒ¨/èº¯å¹²çš„å¹³è¡¡æŒ‡æ ‡ä¹Ÿèƒ½é˜²æ­¢è¯¯åˆ¤ã€‚
- é¿å…â€œè„šåˆšè¿ˆå‡ºå°šæœªç«™ç¨³â€çš„ç”»é¢æå‰è¿›å…¥ç¬¬äºŒé˜¶æ®µã€‚

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

### æ”¹è¿›å‰çš„é—®é¢˜

ç”¨æˆ·åé¦ˆï¼š"ç¬¬äºŒå¸§çš„é€‰å–ä»ä¸æ˜¯å¾ˆå‡†ç¡®ï¼Œä½ é€‰å–çš„æ˜¯è…¿éƒ¨æ‰“å¼€åˆæœŸ"

**åˆ†æ**ï¼š
- åŸç®—æ³•åªå…³æ³¨ `foot_distance` å’Œ `arm_height_ratio`
- å¿½ç•¥äº†"å¤´éƒ¨ç§»åˆ°ä¸¤è„šä¸­ç‚¹"è¿™ä¸ªå…³é”®ç‰¹å¾
- å¯èƒ½é€‰åˆ°è„šåˆšå¼€å§‹æ‰“å¼€ä½†é‡å¿ƒè¿˜æœªè½¬ç§»çš„å¸§

### æ”¹è¿›åçš„ä¼˜åŠ¿

âœ… **ç²¾ç¡®æ•æ‰é‡å¿ƒè½¬ç§»æ—¶åˆ»**
- `nose_center_offset` æƒé‡ 7.0 ç¡®ä¿å¤´éƒ¨å±…ä¸­çš„å†³å®šæ€§ä½œç”¨
- åªæœ‰å½“å¤´éƒ¨çœŸæ­£ç§»åˆ°ä¸¤è„šä¸­ç‚¹æ­£ä¸Šæ–¹æ—¶ï¼Œæ‰ä¼šè·å¾—é«˜åˆ†

âœ… **å¤šç‰¹å¾ç»¼åˆåŒ¹é…**
```
æ€»ç›¸ä¼¼åº¦ â‰ˆ 
    7.0 Ã— å¤´éƒ¨å±…ä¸­ç›¸ä¼¼åº¦ +
    5.5 Ã— æ‰‹è‡‚é«˜åº¦ç›¸ä¼¼åº¦ +
    5.5 Ã— è„šè·ç›¸ä¼¼åº¦ +
    4.0 Ã— éª¨ç›†å¹³è¡¡ç›¸ä¼¼åº¦ +
    3.0 Ã— è‚©éƒ¨å¹³è¡¡ç›¸ä¼¼åº¦ +
    3.5 Ã— èº¯å¹²å€¾æ–œç›¸ä¼¼åº¦ +
    ...
```

âœ… **é¿å…è¯¯é€‰**
- å¦‚æœå¤´éƒ¨æœªå±…ä¸­ï¼Œå³ä½¿è„šè·å’Œæ‰‹è‡‚é«˜åº¦æ¥è¿‘ï¼Œæ€»åˆ†ä¹Ÿä¼šæ˜¾è‘—é™ä½
- åŠ¨æ€è§„åˆ’ä¼šä¼˜å…ˆé€‰æ‹©å¤´éƒ¨å±…ä¸­+è„šè·æ‰“å¼€çš„å¸§

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•æ–¹æ³•

```bash
# è¿è¡Œæ”¹è¿›åçš„ç®—æ³•
python test_frame_selector.py -v video/qishi2.mp4
```

### é¢„æœŸè¾“å‡º

```
æ ‡å‡†å¸§2 (é‡å¿ƒè½¬ç§»æœŸ): è§†é¢‘å¸§ç´¢å¼• XX
  ç›¸ä¼¼åº¦: XX.XX%
  arm_height_ratio: 0.9XX (æ ‡å‡†: 0.932)
  foot_distance: 0.1XX (æ ‡å‡†: 0.187)
  nose_center_offset: -0.00X (æ ‡å‡†: -0.002) â† åº”è¯¥æ¥è¿‘0
```

### éªŒè¯è¦ç‚¹

âœ… `nose_center_offset` åº”è¯¥æ¥è¿‘ -0.002ï¼ˆå³æ¥è¿‘0ï¼‰
âœ… `foot_distance` åº”è¯¥åœ¨ 0.15-0.22 èŒƒå›´å†…
âœ… `arm_height_ratio` åº”è¯¥åœ¨ 0.85-0.95 èŒƒå›´å†…
âœ… ç¬¬2å¸§ä¸ç¬¬1å¸§çš„æ—¶é—´é—´éš”åº”è¯¥åˆç†ï¼ˆä¸ä¼šå¤ªè¿‘ï¼‰

---

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### ä¸ºä»€ä¹ˆ `nose_center_offset` å¦‚æ­¤é‡è¦ï¼Ÿ

1. **ç‰©ç†æ„ä¹‰**ï¼šå¤´éƒ¨ï¼ˆé¼»å­ï¼‰ä½ç½®åæ˜ èº«ä½“é‡å¿ƒ
   - èµ·å§‹æ—¶ï¼šè„šå¹¶æ‹¢ï¼Œå¤´éƒ¨åœ¨è„šçš„æ­£ä¸Šæ–¹ï¼ˆoffsetæ¥è¿‘0ï¼‰
   - é‡å¿ƒè½¬ç§»ï¼šè„šæ‰“å¼€ï¼Œå¤´éƒ¨ç§»åˆ°ä¸¤è„šä¸­ç‚¹ï¼ˆoffsetä»æ¥è¿‘0ï¼‰
   - å¦‚æœå¤´éƒ¨åç¦»ä¸­ç‚¹ï¼Œè¯´æ˜é‡å¿ƒè½¬ç§»ä¸å®Œæ•´

2. **åŒºåˆ†åº¦é«˜**ï¼š
   - å¦‚æœåªçœ‹ `foot_distance`ï¼Œå¾ˆéš¾åŒºåˆ†"åˆšå¼€å§‹æ‰“å¼€"å’Œ"å·²å®Œå…¨è½¬ç§»"
   - åŠ å…¥ `nose_center_offset`ï¼Œå¯ä»¥ç²¾ç¡®åŒºåˆ†è¿™ä¸¤ä¸ªé˜¶æ®µ

3. **ç¬¦åˆå¤ªææ‹³åŸç†**ï¼š
   - å¤ªææ‹³å¼ºè°ƒ"è™šå®è½¬æ¢"
   - é‡å¿ƒå¿…é¡»å®Œå…¨è½¬ç§»åˆ°ä¸¤è„šä¹‹é—´ï¼Œä¿æŒå¹³è¡¡
   - å¤´éƒ¨å±…ä¸­æ˜¯é‡å¿ƒè½¬ç§»å®Œæˆçš„æ ‡å¿—

### æƒé‡åˆ†é…ç­–ç•¥

```
ç¬¬2å¸§æ€»æƒé‡ â‰ˆ 38.5

nose_center_offset: 7.0   (18.2%) â† æœ€é«˜å•é¡¹æƒé‡
arm_height_ratio:   5.5   (14.3%)
foot_distance:      5.5   (14.3%)
hip_balance_left:   4.0   (10.4%)
hip_balance_right:  4.0   (10.4%)
shoulder_balance_left: 3.0 (7.8%)
shoulder_balance_right: 3.0 (7.8%)
torso_angle:        3.5   (9.1%)
hand_distance:      2.0   (5.2%)
avg_visibility:     1.0   (2.6%)
```

**è®¾è®¡ç†å¿µ**ï¼š
- å¤´éƒ¨å±…ä¸­ä»æ˜¯ä¸»å¯¼æŒ‡æ ‡ï¼Œä½†éª¨ç›†/è‚©éƒ¨å¹³è¡¡ä¸èº¯å¹²è§’åº¦å…±åŒç¡®ä¿èº«ä½“å·²å›æ­£ã€‚
- æ‰‹è‡‚é«˜åº¦ä¸è„šè·å æ®çº¦ 28%ï¼ŒéªŒè¯è„šè½åœ°ä¸”æ‰‹è‡‚å°šæœªä¸‹è½ã€‚
- è¾…åŠ©ç‰¹å¾ï¼ˆå¯è§æ€§ã€æ‰‹è·ç­‰ï¼‰ç¡®ä¿æ•´ä½“å§¿æ€è´¨é‡ä¸æ£€æµ‹å¯é æ€§ã€‚

---

## ğŸ“ æ›´æ–°çš„æ–‡æ¡£

å·²åŒæ­¥æ›´æ–°ä»¥ä¸‹æ–‡æ¡£ï¼š

1. âœ… `frame_selector.py` - æ ¸å¿ƒç®—æ³•ä»£ç 
2. âœ… `FRAME_SELECTION_GUIDE.md` - æŠ€æœ¯æ–‡æ¡£
3. âœ… `SOLUTION_SUMMARY.md` - è§£å†³æ–¹æ¡ˆæ€»ç»“
4. âœ… `quick_start_example.py` - å¿«é€Ÿå…¥é—¨
5. âœ… `ç®—æ³•æ”¹è¿›è¯´æ˜_v2.md` - æœ¬æ–‡æ¡£

---

## ğŸ¯ æ€»ç»“

### å…³é”®æ”¹è¿›

âœ… **è¯†åˆ«ç²¾åº¦æå‡**ï¼š`nose_center_offset` æƒé‡æå‡è‡³ 7.0ï¼Œå¹¶åŠ å…¥éª¨ç›†/è‚©éƒ¨å¹³è¡¡ç¡¬çº¦æŸ  
âœ… **è¯­ä¹‰æ›´å‡†ç¡®**ï¼šç¬¬2å¸§ä»"è…¿éƒ¨æ‰“å¼€åˆæœŸ"æ”¹ä¸º"é‡å¿ƒè½¬ç§»æœŸ"  
âœ… **ç‰©ç†æ„ä¹‰æ˜ç¡®**ï¼šå¼ºè°ƒ"å¤´éƒ¨ç§»åˆ°ä¸¤è„šä¸­ç‚¹æ­£ä¸Šæ–¹"  
âœ… **æ–‡æ¡£å…¨é¢æ›´æ–°**ï¼šæ‰€æœ‰ç›¸å…³æ–‡æ¡£åŒæ­¥æ›´æ–°  

### ç”¨æˆ·ä½“éªŒ

- ğŸ¯ æ›´å‡†ç¡®åœ°æ•æ‰é‡å¿ƒè½¬ç§»æ—¶åˆ»
- ğŸ“Š æ›´ç¬¦åˆå¤ªææ‹³åŠ¨ä½œçš„å®é™…ç‰¹ç‚¹
- ğŸ” æ›´æ˜“äºç†è§£å’ŒéªŒè¯é€‰å¸§ç»“æœ

---

**æ„Ÿè°¢ç”¨æˆ·çš„å®è´µåé¦ˆï¼è¿™æ¬¡æ”¹è¿›è®©ç®—æ³•æ›´åŠ ç²¾ç¡®å’Œä¸“ä¸šï¼** ğŸ’ªâœ¨

